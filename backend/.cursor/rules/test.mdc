---
description: 
globs: test_*.py
alwaysApply: false
---
# æµ‹è¯•æ¶æ„è¯´æ˜æ–‡æ¡£

## ğŸ“‹ æ¦‚è¿°

æœ¬æ–‡æ¡£æè¿°äº†ä¿¡ç”¨å¡ç®¡ç†ç³»ç»Ÿåç«¯çš„ä¼˜åŒ–æµ‹è¯•æ¶æ„ï¼Œæä¾›äº†ä¸‰å±‚æµ‹è¯•ç»“æ„ï¼Œæ”¯æŒä¸åŒç±»å‹çš„æµ‹è¯•éœ€æ±‚ã€‚

## ğŸ—ï¸ æµ‹è¯•æ¶æ„è®¾è®¡

### æ ¸å¿ƒè®¾è®¡ç†å¿µ

1. **åˆ†å±‚æµ‹è¯•**: å•å…ƒæµ‹è¯• â†’ é›†æˆæµ‹è¯• â†’ æ€§èƒ½æµ‹è¯•
2. **ç»Ÿä¸€æ¥å£**: é€šè¿‡åŸºç¡€ç±»å°è£…å…¬å…±æµ‹è¯•æ–¹æ³•
3. **å®¢æˆ·ç«¯æŠ½è±¡**: æ”¯æŒFastAPI TestClientå’ŒRequestsä¸¤ç§å®¢æˆ·ç«¯
4. **é…ç½®é©±åŠ¨**: é€šè¿‡é…ç½®æ–‡ä»¶ç®¡ç†ä¸åŒæµ‹è¯•ç±»å‹
5. **è‡ªåŠ¨åŒ–è¿è¡Œ**: ç»Ÿä¸€çš„æµ‹è¯•è¿è¡Œå™¨æ”¯æŒé€‰æ‹©æ€§æ‰§è¡Œ

### ç›®å½•ç»“æ„

```
tests/
â”œâ”€â”€ base_test.py                      # æµ‹è¯•åŸºç¡€è®¾æ–½
â”œâ”€â”€ test_runner.py                    # ç»Ÿä¸€æµ‹è¯•è¿è¡Œå™¨
â”œâ”€â”€ conftest.py                       # pytesté…ç½®å’Œfixture
â”œâ”€â”€ unit/                            # å•å…ƒæµ‹è¯•ï¼ˆFastAPI TestClientï¼‰
â”‚   â”œâ”€â”€ test_recommendations_unit.py
â”‚   â””â”€â”€ test_statistics_unit.py
â”œâ”€â”€ integration/                     # é›†æˆæµ‹è¯•ï¼ˆçœŸå®HTTPè¯·æ±‚ï¼‰
â”‚   â”œâ”€â”€ test_recommendations_integration.py
â”‚   â””â”€â”€ test_statistics_integration.py
â”œâ”€â”€ performance/                     # æ€§èƒ½æµ‹è¯•ï¼ˆåŸºå‡†æµ‹è¯•ï¼‰
â”‚   â”œâ”€â”€ test_recommendations_performance.py
â”‚   â””â”€â”€ test_statistics_performance.py
â”œâ”€â”€ legacy/                         # åŸæœ‰æµ‹è¯•æ–‡ä»¶ï¼ˆå…¼å®¹æ€§ï¼‰
â”‚   â”œâ”€â”€ test_cards.py
â”‚   â”œâ”€â”€ test_transactions.py
â”‚   â””â”€â”€ ...
â”œâ”€â”€ TESTING_ARCHITECTURE.md         # æœ¬æ–‡æ¡£
â””â”€â”€ README.md                       # æµ‹è¯•ä½¿ç”¨è¯´æ˜
```

## ğŸ§ª æµ‹è¯•ç±»å‹è¯¦è§£

### 1. å•å…ƒæµ‹è¯• (Unit Tests)

**ä½ç½®**: `tests/unit/`
**å®¢æˆ·ç«¯**: FastAPI TestClient
**ç‰¹ç‚¹**:
- âœ… å¿«é€Ÿæ‰§è¡Œï¼ˆæ¯«ç§’çº§ï¼‰
- âœ… æ— å¤–éƒ¨ä¾èµ–
- âœ… å¯å¹¶è¡Œæ‰§è¡Œ
- âœ… é€‚åˆCI/CD
- âœ… æµ‹è¯•å†…éƒ¨é€»è¾‘

**ç¤ºä¾‹**:
```python
from tests.base_test import FastAPITestClient, BaseRecommendationTest

@pytest.mark.unit
class TestRecommendationsUnit(BaseRecommendationTest):
    def setup_class(self):
        self.client = FastAPITestClient()
        self.setup_test_user()
```

### 2. é›†æˆæµ‹è¯• (Integration Tests)

**ä½ç½®**: `tests/integration/`
**å®¢æˆ·ç«¯**: Requests HTTPå®¢æˆ·ç«¯
**ç‰¹ç‚¹**:
- ğŸŒ çœŸå®HTTPè¯·æ±‚
- ğŸ”— ç«¯åˆ°ç«¯æµ‹è¯•
- ğŸ›¡ï¸ ç½‘ç»œå±‚éªŒè¯
- ğŸš€ éœ€è¦æ‰‹åŠ¨å¯åŠ¨æœåŠ¡å™¨ï¼ˆä¸»è¿›ç¨‹æ¨¡å¼ï¼‰
- ğŸ“Š çœŸå®ç”¨æˆ·åœºæ™¯

**ç¤ºä¾‹**:
```python
from tests.base_test import RequestsTestClient, BaseRecommendationTest

@pytest.mark.integration
@pytest.mark.requires_server
class TestRecommendationsIntegration(BaseRecommendationTest):
    def setup_class(self):
        self.client = RequestsTestClient()
        self._check_server_availability()
```

### 3. æ€§èƒ½æµ‹è¯• (Performance Tests)

**ä½ç½®**: `tests/performance/`
**å®¢æˆ·ç«¯**: FastAPI TestClientï¼ˆç¨³å®šæ€§ï¼‰
**ç‰¹ç‚¹**:
- âš¡ æ€§èƒ½åŸºå‡†æµ‹è¯•
- ğŸ“ˆ å“åº”æ—¶é—´åˆ†æ
- ğŸš€ å¹¶å‘å‹åŠ›æµ‹è¯•
- ğŸ’¾ å†…å­˜ä½¿ç”¨ç›‘æ§
- ğŸ“Š è¯¦ç»†æ€§èƒ½æŠ¥å‘Š

**æ¶æ„æ¨¡å¼**ï¼ˆé‡è¦æ›´æ–°ï¼‰:
```python
from tests.base_test import FastAPITestClient, BaseRecommendationTest, TestPerformanceMixin

@pytest.mark.performance
@pytest.mark.slow
class TestRecommendationsPerformance(TestPerformanceMixin):
    def setup_method(self):
        """ä½¿ç”¨setup_methodè€Œä¸æ˜¯pytest fixture"""
        self.client = FastAPITestClient()
        self.api_test = BaseRecommendationTest(self.client)
        self.api_test.setup_test_user()
    
    def test_performance_benchmark(self):
        """é€šè¿‡ç»„åˆæ¨¡å¼è°ƒç”¨APIæµ‹è¯•æ–¹æ³•"""
        metrics = self._measure_multiple_requests(
            lambda: self.api_test.test_get_user_profile(),
            count=100
        )
        assert metrics["avg_response_time"] < 0.5
```

## ğŸ› ï¸ æ ¸å¿ƒç»„ä»¶

### BaseTestClient æŠ½è±¡ç±»

æä¾›ç»Ÿä¸€çš„HTTPå®¢æˆ·ç«¯æ¥å£ï¼š

```python
class BaseTestClient(ABC):
    @abstractmethod
    def get(self, url: str, headers: Optional[Dict] = None, params: Optional[Dict] = None):
        pass
    
    @abstractmethod  
    def post(self, url: str, json: Optional[Dict] = None, headers: Optional[Dict] = None):
        pass
```

**å®ç°ç±»**:
- `FastAPITestClient`: åŸºäºFastAPI TestClient
- `RequestsTestClient`: åŸºäºrequestsåº“

### BaseAPITest åŸºç¡€ç±»

å°è£…é€šç”¨æµ‹è¯•æ–¹æ³•ï¼š

```python
class BaseAPITest:
    def setup_test_user(self) -> Dict[str, Any]:
        """è‡ªåŠ¨æ³¨å†Œå’Œç™»å½•æµ‹è¯•ç”¨æˆ·"""
        
    def create_test_card(self, card_data: Optional[Dict] = None) -> Dict[str, Any]:
        """åˆ›å»ºæµ‹è¯•ä¿¡ç”¨å¡"""
        
    def assert_api_success(self, response, expected_status: int = 200) -> Dict[str, Any]:
        """æ–­è¨€APIå“åº”æˆåŠŸ"""
        
    def assert_pagination_response(self, data: Dict[str, Any]) -> None:
        """æ–­è¨€åˆ†é¡µå“åº”æ ¼å¼"""
```

### ä¸“ç”¨æµ‹è¯•åŸºç±»

- `BaseRecommendationTest`: æ¨èæ¥å£æµ‹è¯•åŸºç±»
- `BaseStatisticsTest`: ç»Ÿè®¡æ¥å£æµ‹è¯•åŸºç±»  
- `TestPerformanceMixin`: æ€§èƒ½æµ‹è¯•æ··å…¥ç±»
- `TestDataGenerator`: æµ‹è¯•æ•°æ®ç”Ÿæˆå™¨

## ğŸ“‹ ä¾èµ–è¦æ±‚

### å¿…éœ€çš„PythonåŒ…

```txt
# æ ¸å¿ƒæµ‹è¯•ä¾èµ–
pytest>=7.0.0
pytest-asyncio>=0.20.0
pytest-xdist>=3.0.0          # å¹¶è¡Œæµ‹è¯•æ”¯æŒ
pytest-cov>=4.0.0            # è¦†ç›–ç‡æµ‹è¯•
requests>=2.28.0             # é›†æˆæµ‹è¯•HTTPå®¢æˆ·ç«¯

# å¯é€‰ä¾èµ–
pytest-timeout>=2.1.0         # æ€§èƒ½æµ‹è¯•è¶…æ—¶æ§åˆ¶ï¼ˆå¯é€‰ï¼‰
pytest-benchmark>=4.0.0      # æ€§èƒ½åŸºå‡†æµ‹è¯•ï¼ˆå¯é€‰ï¼‰
pytest-html>=3.0.0           # HTMLæµ‹è¯•æŠ¥å‘Šï¼ˆå¯é€‰ï¼‰
```

### å®‰è£…å»ºè®®

```bash
# å®‰è£…æ ¸å¿ƒä¾èµ–ï¼ˆå¿…éœ€ï¼‰
pip install pytest pytest-asyncio pytest-xdist pytest-cov requests

# å®‰è£…å¯é€‰ä¾èµ–ï¼ˆæ¨èï¼‰
pip install pytest-timeout pytest-benchmark pytest-html

# æˆ–è€…ä½¿ç”¨é¡¹ç›®çš„requirementsæ–‡ä»¶
pip install -r requirements.txt
```

## ğŸš€ è¿è¡Œæµ‹è¯•

### ä½¿ç”¨æµ‹è¯•è¿è¡Œå™¨ï¼ˆæ¨èï¼‰

```bash
# åˆ—å‡ºå¯ç”¨æµ‹è¯•ç±»å‹
python tests/test_runner.py list

# è¿è¡Œå•å…ƒæµ‹è¯•
python tests/test_runner.py unit

# è¿è¡Œé›†æˆæµ‹è¯•ï¼ˆéœ€è¦æ‰‹åŠ¨å¯åŠ¨æœåŠ¡å™¨ï¼‰
# ç¬¬ä¸€æ­¥ï¼šåœ¨å¦ä¸€ä¸ªç»ˆç«¯å¯åŠ¨æœåŠ¡å™¨
python start.py dev
# ç¬¬äºŒæ­¥ï¼šè¿è¡Œé›†æˆæµ‹è¯•
python tests/test_runner.py integration

# è¿è¡Œæ€§èƒ½æµ‹è¯•
python tests/test_runner.py performance

# è¿è¡Œæ‰€æœ‰æµ‹è¯•
python tests/test_runner.py all

# è¯¦ç»†è¾“å‡ºæ¨¡å¼
python tests/test_runner.py unit -v

# ç”Ÿæˆæµ‹è¯•æŠ¥å‘Š
python tests/test_runner.py all -r
```

### ç›´æ¥ä½¿ç”¨pytest

```bash
# è¿è¡Œå•å…ƒæµ‹è¯•
pytest tests/unit/ -m unit

# è¿è¡Œé›†æˆæµ‹è¯•ï¼ˆéœ€è¦æ‰‹åŠ¨å¯åŠ¨æœåŠ¡å™¨ï¼‰
pytest tests/integration/ -m integration

# è¿è¡Œæ€§èƒ½æµ‹è¯•
pytest tests/performance/ -m performance

# è¿è¡Œç‰¹å®šæµ‹è¯•æ–‡ä»¶
pytest tests/unit/test_recommendations_unit.py -v

# æ’é™¤æ…¢é€Ÿæµ‹è¯•
pytest -m "not slow"

# å¹¶è¡Œæ‰§è¡Œå•å…ƒæµ‹è¯•
pytest tests/unit/ -n auto

# å¸¦è¶…æ—¶æ§åˆ¶çš„æ€§èƒ½æµ‹è¯•ï¼ˆéœ€è¦pytest-timeoutæ’ä»¶ï¼‰
pytest tests/performance/ -m performance --timeout=300
```

## ğŸ“Š æ€§èƒ½åŸºå‡†

### å“åº”æ—¶é—´åŸºå‡†

| æ¥å£ç±»å‹ | å¹³å‡å“åº”æ—¶é—´ | P95å“åº”æ—¶é—´ | æ¯ç§’è¯·æ±‚æ•° |
|----------|--------------|-------------|------------|
| ç”¨æˆ·ç”»åƒ | < 0.5s | < 1.0s | > 20 RPS |
| æ¨èç”Ÿæˆ | < 2.0s | < 5.0s | > 5 RPS |
| æ¨èåˆ—è¡¨ | < 0.3s | < 1.0s | > 30 RPS |
| æœç´¢åŠŸèƒ½ | < 0.8s | < 2.0s | > 15 RPS |

### å¹¶å‘æ€§èƒ½åŸºå‡†

| å¹¶å‘çº§åˆ« | æˆåŠŸç‡ | å¹³å‡å“åº”æ—¶é—´ | å¤‡æ³¨ |
|----------|--------|--------------|------|
| 5å¹¶å‘ | > 95% | < 1.0s | è½»è´Ÿè½½ |
| 10å¹¶å‘ | > 90% | < 2.0s | ä¸­è´Ÿè½½ |
| 20å¹¶å‘ | > 85% | < 3.0s | é‡è´Ÿè½½ |

## ğŸ”§ é…ç½®å’Œå®šåˆ¶

### pytestæ ‡è®°ï¼ˆå·²ä¿®å¤ï¼‰

```ini
[pytest]
markers =
    unit: å•å…ƒæµ‹è¯•ï¼ˆä½¿ç”¨FastAPI TestClientï¼‰
    integration: é›†æˆæµ‹è¯•ï¼ˆçœŸå®HTTPè¯·æ±‚ï¼‰
    performance: æ€§èƒ½æµ‹è¯•ï¼ˆåŸºå‡†æµ‹è¯•å’Œå‹åŠ›æµ‹è¯•ï¼‰
    legacy: åŸæœ‰æµ‹è¯•æ–‡ä»¶
    slow: è¿è¡Œæ—¶é—´è¾ƒé•¿çš„æµ‹è¯•
    requires_server: éœ€è¦è¿è¡ŒæœåŠ¡å™¨çš„æµ‹è¯•
    auth: è®¤è¯ç›¸å…³æµ‹è¯•
    crud: CRUDæ“ä½œæµ‹è¯•
    statistics: ç»Ÿè®¡åŠŸèƒ½æµ‹è¯•
```

### æµ‹è¯•é…ç½®

```python
# tests/test_runner.py ä¸­çš„é…ç½®
test_configs = {
    "unit": {
        "description": "å•å…ƒæµ‹è¯• (FastAPI TestClient)",
        "path": "tests/unit/",
        "pattern": "test_*_unit.py",
        "markers": "unit",
        "parallel": True,
        "coverage": True
    },
    "integration": {
        "description": "é›†æˆæµ‹è¯• (çœŸå®HTTPè¯·æ±‚)",
        "path": "tests/integration/",
        "pattern": "test_*_integration.py",
        "markers": "integration", 
        "requires_server": True
    },
    "performance": {
        "description": "æ€§èƒ½æµ‹è¯• (åŸºå‡†æµ‹è¯•å’Œå‹åŠ›æµ‹è¯•)",
        "path": "tests/performance/",
        "pattern": "test_*_performance.py",
        "markers": "performance",
        "timeout": 300  # å¯é€‰ï¼Œéœ€è¦pytest-timeoutæ’ä»¶
    }
}
```

## â— å¸¸è§é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆ

### 1. pytestæ ‡è®°è­¦å‘Š

**é—®é¢˜**: `Unknown pytest.mark.integration` è­¦å‘Š

**è§£å†³æ–¹æ¡ˆ**: 
- ç¡®ä¿`pytest.ini`ä½¿ç”¨æ­£ç¡®çš„èŠ‚å`[pytest]`è€Œä¸æ˜¯`[tool:pytest]`
- æ£€æŸ¥æ–‡ä»¶ç¼–ç ï¼Œç¡®ä¿æ²¡æœ‰ä¸­æ–‡ä¹±ç 
- è¿è¡Œ`pytest --markers`éªŒè¯æ ‡è®°å·²æ³¨å†Œ

### 2. é›†æˆæµ‹è¯•æœåŠ¡å™¨å¯åŠ¨

**é—®é¢˜**: é›†æˆæµ‹è¯•éœ€è¦æœåŠ¡å™¨è¿è¡Œä½†å¯åŠ¨å¤æ‚

**è§£å†³æ–¹æ¡ˆ**: 
- é›†æˆæµ‹è¯•ä¸å†è‡ªåŠ¨å¯åŠ¨æœåŠ¡å™¨ï¼Œé¿å…è¿›ç¨‹ç®¡ç†å¤æ‚æ€§
- è¦æ±‚ç”¨æˆ·æ‰‹åŠ¨å¯åŠ¨æœåŠ¡å™¨ä½œä¸ºä¸»è¿›ç¨‹: `python start.py dev`
- æµ‹è¯•è¿è¡Œå™¨åªæ£€æŸ¥æœåŠ¡å™¨æ˜¯å¦å¯ç”¨ï¼Œå¹¶æä¾›æ¸…æ™°çš„å¯åŠ¨æŒ‡å¯¼

### 3. æ€§èƒ½æµ‹è¯•æ¶æ„é”™è¯¯

**é—®é¢˜**: æ€§èƒ½æµ‹è¯•ç±»ä½¿ç”¨`@pytest.fixture`å¯¼è‡´é”™è¯¯

**è§£å†³æ–¹æ¡ˆ**: 
- ä½¿ç”¨`setup_method()`æ›¿ä»£`@pytest.fixture(scope="class", autouse=True)`
- ä½¿ç”¨ç»„åˆæ¨¡å¼ï¼š`self.api_test = BaseRecommendationTest(self.client)`
- è°ƒç”¨æ–¹å¼ï¼š`self.api_test.test_xxx()`è€Œä¸æ˜¯`self.test_xxx()`

### 4. pytest-timeoutæ’ä»¶ç¼ºå¤±

**é—®é¢˜**: `unrecognized arguments: --timeout 300`

**è§£å†³æ–¹æ¡ˆ**: 
```bash
# å®‰è£…pytest-timeoutæ’ä»¶
pip install pytest-timeout

# æˆ–è€…ä»æµ‹è¯•é…ç½®ä¸­ç§»é™¤timeoutè®¾ç½®
# åœ¨test_runner.pyä¸­åˆ é™¤æˆ–æ³¨é‡Štimeouté…ç½®
```

### 5. Windows PowerShellå…¼å®¹æ€§

**é—®é¢˜**: åœ¨Windows PowerShellä¸­è¿è¡Œæµ‹è¯•å‡ºç°ç¼–ç æˆ–è¿›ç¨‹é—®é¢˜

**è§£å†³æ–¹æ¡ˆ**: 
- æµ‹è¯•è¿è¡Œå™¨å·²å¢åŠ Windowså…¼å®¹æ€§å¤„ç†
- ä½¿ç”¨æ­£ç¡®çš„è¿›ç¨‹ç»ˆæ­¢æ–¹å¼ï¼ˆ`terminate()`è€Œä¸æ˜¯`kill()`ï¼‰
- æ­£ç¡®å¤„ç†ç¼–ç é—®é¢˜

### 6. pytestæ— æ³•æ”¶é›†æµ‹è¯•æ–‡ä»¶

**é—®é¢˜**: `collected 0 items` æˆ–æµ‹è¯•ç±»æ— æ³•è¢«å‘ç°

**åŸå› **: 
- æµ‹è¯•ç±»ç»§æ‰¿äº†`BaseAPITest`ä½†æ²¡æœ‰æ­£ç¡®åˆå§‹åŒ–çˆ¶ç±»
- ä½¿ç”¨äº†é”™è¯¯çš„ç±»æ„é€ æ–¹å¼å¯¼è‡´pytestæ— æ³•è¯†åˆ«æµ‹è¯•æ–¹æ³•

**è§£å†³æ–¹æ¡ˆ**: 
```python
# âŒ é”™è¯¯æ–¹å¼ - ç›´æ¥ç»§æ‰¿BaseAPITest
class TestTransactionsUnit(BaseAPITest):
    def setup_method(self):
        super().__init__(client)  # ä¼šå¯¼è‡´pytestæ— æ³•æ”¶é›†

# âœ… æ­£ç¡®æ–¹å¼ - ä½¿ç”¨ç»„åˆæ¨¡å¼
class TestTransactionsUnit:
    def setup_method(self):
        self.client = FastAPITestClient()
        self.api_test = BaseAPITest(self.client)  # ç»„åˆè€Œä¸æ˜¯ç»§æ‰¿
        self.test_user = self.api_test.setup_test_user()
        self.headers = {"Authorization": f"Bearer {self.test_user['token']}"}
```

### 7. APIå“åº”å­—æ®µä¸åŒ¹é…

**é—®é¢˜**: æµ‹è¯•æœŸæœ›çš„å­—æ®µåä¸å®é™…APIè¿”å›çš„å­—æ®µä¸ä¸€è‡´

**å¸¸è§ä¸åŒ¹é…æƒ…å†µ**:
- åˆ†é¡µå­—æ®µï¼šæœŸæœ›`page`å®é™…ä¸º`current_page`
- ç»Ÿè®¡å­—æ®µï¼šæœŸæœ›`total_expense`å®é™…ä¸º`expense_amount`
- åˆ†é¡µå¤§å°ï¼šæœŸæœ›`size`å®é™…ä¸º`page_size`

**è§£å†³æ–¹æ¡ˆ**: 
```python
# æ£€æŸ¥å®é™…APIå“åº”æ ¼å¼ï¼Œæ›´æ–°æµ‹è¯•æœŸæœ›
# åˆ†é¡µå“åº”
assert data["pagination"]["current_page"] == 1  # ä¸æ˜¯page
assert data["pagination"]["page_size"] == 5     # ä¸æ˜¯size

# ç»Ÿè®¡å“åº”  
assert "expense_amount" in data  # ä¸æ˜¯total_expense
assert "income_amount" in data   # ä¸æ˜¯total_income
```

### 8. æšä¸¾å€¼å’Œæ•°æ®éªŒè¯é”™è¯¯

**é—®é¢˜**: æµ‹è¯•ä½¿ç”¨äº†APIä¸æ”¯æŒçš„æšä¸¾å€¼å¯¼è‡´422æˆ–500é”™è¯¯

**å¸¸è§é”™è¯¯æšä¸¾**:
- äº¤æ˜“ç±»å‹ï¼š`"income"`ï¼ˆåº”ä½¿ç”¨`"payment"`ï¼‰
- äº¤æ˜“åˆ†ç±»ï¼š`"grocery"`ï¼ˆåº”ä½¿ç”¨`"other"`ï¼‰
- æ— æ•ˆUUIDæ ¼å¼å¯¼è‡´500è€Œä¸æ˜¯400é”™è¯¯

**è§£å†³æ–¹æ¡ˆ**: 
```python
# ä½¿ç”¨æ­£ç¡®çš„æšä¸¾å€¼
valid_transaction_types = ["expense", "payment", "refund", "transfer", "withdrawal", "fee"]
valid_categories = ["dining", "shopping", "transport", "entertainment", "medical", "education", "travel", "other"]

# å¯¹äºé”™è¯¯å¤„ç†æµ‹è¯•ï¼ŒæœŸæœ›å®é™…çš„çŠ¶æ€ç 
assert response.status_code in [400, 500]  # åç«¯å¯èƒ½è¿”å›500è€Œä¸æ˜¯400
```

### 9. æ¥å£è·¯å¾„å’Œå‚æ•°ä¸åŒ¹é…

**é—®é¢˜**: æµ‹è¯•ä½¿ç”¨çš„æ¥å£è·¯å¾„ä¸å®é™…APIä¸ç¬¦

**å¸¸è§è·¯å¾„é”™è¯¯**:
- æœˆåº¦è¶‹åŠ¿ï¼š`/statistics/monthly`ï¼ˆåº”ä¸º`/statistics/monthly-trend`ï¼‰
- æ—¥æœŸå‚æ•°ï¼šç®€å•dateæ ¼å¼ï¼ˆåº”ä¸ºdatetimeæ ¼å¼ï¼‰

**è§£å†³æ–¹æ¡ˆ**: 
```python
# ä½¿ç”¨æ­£ç¡®çš„æ¥å£è·¯å¾„
response = self.client.get("/api/transactions/statistics/monthly-trend")  # ä¸æ˜¯monthly

# ä½¿ç”¨æ­£ç¡®çš„æ—¥æœŸæ—¶é—´æ ¼å¼
start_date = "2024-06-05T00:00:00"  # ä¸æ˜¯ "2024-06-05"
end_date = "2024-06-10T23:59:59"    # ä¸æ˜¯ "2024-06-10"
```

## ğŸ¯ æœ€ä½³å®è·µ

### 1. æµ‹è¯•å‘½åè§„èŒƒ

```python
# å•å…ƒæµ‹è¯•
tests/unit/test_[module]_unit.py
class Test[Module]Unit:
    def test_01_[specific_functionality](self):

# é›†æˆæµ‹è¯•
tests/integration/test_[module]_integration.py  
class Test[Module]Integration:
    def test_01_[user_scenario](self):

# æ€§èƒ½æµ‹è¯•ï¼ˆä¿®å¤åçš„æ¶æ„ï¼‰
tests/performance/test_[module]_performance.py
class Test[Module]Performance(TestPerformanceMixin):
    def setup_method(self):
        self.client = FastAPITestClient()
        self.api_test = Base[Module]Test(self.client)
        
    def test_01_[performance_aspect](self):
        # é€šè¿‡ç»„åˆæ¨¡å¼è°ƒç”¨APIæµ‹è¯•
        result = self.api_test.test_xxx()
```

### 2. æµ‹è¯•æ•°æ®ç®¡ç†

```python
# ä½¿ç”¨TestDataGeneratorç”Ÿæˆæµ‹è¯•æ•°æ®
test_cards = TestDataGenerator.generate_test_cards(5)
test_transactions = TestDataGenerator.generate_test_transactions(card_id, 10)

# æ¯ä¸ªæµ‹è¯•ç±»ä½¿ç”¨ç‹¬ç«‹çš„æµ‹è¯•ç”¨æˆ·
self.setup_test_user()  # è‡ªåŠ¨ç”Ÿæˆå”¯ä¸€ç”¨æˆ·
```

### 3. æ€§èƒ½æµ‹è¯•è§„èŒƒï¼ˆæ›´æ–°ï¼‰

```python
# æ­£ç¡®çš„æ€§èƒ½æµ‹è¯•æ¶æ„
class TestAPIPerformance(TestPerformanceMixin):
    def setup_method(self):
        """ä½¿ç”¨setup_methodè€Œä¸æ˜¯fixture"""
        self.client = FastAPITestClient()
        self.api_test = BaseAPITest(self.client)
        self.api_test.setup_test_user()
    
    def test_response_time(self):
        """æµ‹é‡å•æ¬¡è¯·æ±‚æ€§èƒ½"""
        metrics = self._measure_response_time(
            lambda: self.api_test.test_specific_api(),
            max_time=1.0
        )
        
    def test_batch_performance(self):
        """æµ‹é‡æ‰¹é‡è¯·æ±‚æ€§èƒ½"""
        self._test_batch_operations_performance(
            lambda: self.api_test.test_specific_api(),
            count=50,
            max_avg_time=2.0
        )
```

### 4. é”™è¯¯å¤„ç†å’ŒéªŒè¯

```python
# ç»Ÿä¸€çš„å“åº”éªŒè¯
data = self.assert_api_success(response, expected_status=200)

# ç»Ÿä¸€çš„é”™è¯¯éªŒè¯
self.assert_api_error(response, expected_status=404)

# åˆ†é¡µå“åº”éªŒè¯
self.assert_pagination_response(data, min_items=0)
```

### 5. æœåŠ¡å™¨ç®¡ç†

```python
# é›†æˆæµ‹è¯•ä¸­çš„æœåŠ¡å™¨æ£€æŸ¥
def _check_server_availability(self):
    """æ£€æŸ¥æœåŠ¡å™¨æ˜¯å¦å¯ç”¨ï¼Œå¦‚æœä¸å¯ç”¨åˆ™ç»™å‡ºæç¤º"""
    try:
        response = self.client.get("/api/health")
        if response.status_code != 200:
            raise Exception(f"æœåŠ¡å™¨ä¸å¯ç”¨: {response.status_code}")
    except Exception as e:
        pytest.skip(f"æœåŠ¡å™¨ä¸å¯ç”¨ï¼Œè·³è¿‡é›†æˆæµ‹è¯•: {str(e)}")
```

## ğŸ”„ æŒç»­ä¼˜åŒ–

### æµ‹è¯•è¦†ç›–ç‡ç›‘æ§

```bash
# è¿è¡Œå¸¦è¦†ç›–ç‡çš„æµ‹è¯•
pytest tests/unit/ --cov=. --cov-report=html --cov-report=term-missing

# æŸ¥çœ‹è¦†ç›–ç‡æŠ¥å‘Š
open htmlcov/index.html
```

### æ€§èƒ½ç›‘æ§

```bash
# è¿è¡Œæ€§èƒ½æµ‹è¯•å¹¶ç”ŸæˆæŠ¥å‘Š
python tests/test_runner.py performance -v -r

# æŸ¥çœ‹æ€§èƒ½æŠ¥å‘Š
cat tests/TEST_REPORT.md
```

### æµ‹è¯•ç»´æŠ¤

1. **å®šæœŸæ›´æ–°åŸºå‡†**: æ ¹æ®ç³»ç»Ÿæ€§èƒ½å˜åŒ–è°ƒæ•´æ€§èƒ½åŸºå‡†
2. **æ¸…ç†è¿‡æ—¶æµ‹è¯•**: åˆ é™¤ä¸å†ç›¸å…³çš„æµ‹è¯•ç”¨ä¾‹
3. **æ›´æ–°æµ‹è¯•æ•°æ®**: ä¿æŒæµ‹è¯•æ•°æ®ä¸ä¸šåŠ¡åœºæ™¯åŒæ­¥
4. **ä¼˜åŒ–æµ‹è¯•é€Ÿåº¦**: æŒç»­ä¼˜åŒ–æµ‹è¯•æ‰§è¡Œæ—¶é—´
5. **ä¾èµ–ç®¡ç†**: å®šæœŸæ›´æ–°æµ‹è¯•ä¾èµ–åŒ…ç‰ˆæœ¬

## ğŸƒâ€â™‚ï¸ å¿«é€Ÿå¼€å§‹

### 1. ç¯å¢ƒå‡†å¤‡

```bash
# ç¡®ä¿å·²å®‰è£…æ‰€æœ‰ä¾èµ–
pip install -r requirements.txt

# éªŒè¯pytesté…ç½®
pytest --markers
```

### 2. è¿è¡Œç¬¬ä¸€ä¸ªæµ‹è¯•

```bash
# è¿è¡Œå•å…ƒæµ‹è¯•ï¼ˆæœ€å¿«ï¼‰
python tests/test_runner.py unit -v

# æŸ¥çœ‹æµ‹è¯•ç»“æœ
# å¦‚æœæˆåŠŸï¼Œç»§ç»­è¿è¡Œå…¶ä»–æµ‹è¯•ç±»å‹
```

### 3. å®Œæ•´æµ‹è¯•æµç¨‹

```bash
# 1. å•å…ƒæµ‹è¯•
python tests/test_runner.py unit

# 2. é›†æˆæµ‹è¯•ï¼ˆéœ€è¦æ‰‹åŠ¨å¯åŠ¨æœåŠ¡å™¨ï¼‰
# ç»ˆç«¯1: å¯åŠ¨æœåŠ¡å™¨
python start.py dev
# ç»ˆç«¯2: è¿è¡Œé›†æˆæµ‹è¯•
python tests/test_runner.py integration

# 3. æ€§èƒ½æµ‹è¯•
python tests/test_runner.py performance

# 4. ç”Ÿæˆå®Œæ•´æŠ¥å‘Šï¼ˆéœ€è¦æœåŠ¡å™¨è¿è¡Œï¼‰
python tests/test_runner.py all -r
```

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [README.md](./README.md) - æµ‹è¯•ä½¿ç”¨è¯´æ˜
- [RECOMMENDATIONS_TEST_SUMMARY.md](./RECOMMENDATIONS_TEST_SUMMARY.md) - æ¨èæ¥å£æµ‹è¯•æ€»ç»“
- [conftest.py](./conftest.py) - pytesté…ç½®å’Œfixture
- [pytest.ini](../pytest.ini) - pytesté…ç½®æ–‡ä»¶

## ğŸ¤ è´¡çŒ®æŒ‡å—

1. **æ–°å¢æµ‹è¯•**: æŒ‰ç…§ä¸‰å±‚æ¶æ„æ·»åŠ å¯¹åº”ç±»å‹çš„æµ‹è¯•
2. **æ‰©å±•åŸºç±»**: åœ¨base_test.pyä¸­æ·»åŠ é€šç”¨æ–¹æ³•
3. **æ›´æ–°é…ç½®**: åœ¨test_runner.pyä¸­æ·»åŠ æ–°çš„æµ‹è¯•é…ç½®
4. **æ–‡æ¡£æ›´æ–°**: åŠæ—¶æ›´æ–°æ¶æ„æ–‡æ¡£å’Œä½¿ç”¨è¯´æ˜
5. **é—®é¢˜åé¦ˆ**: é‡åˆ°é—®é¢˜è¯·å‚è€ƒ"å¸¸è§é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆ"ç« èŠ‚

## ğŸ”– ç‰ˆæœ¬å†å²

- **v2.1** (å½“å‰): å®Œå–„å¸¸è§é—®é¢˜æ–‡æ¡£ï¼Œæ–°å¢pytestæ”¶é›†é—®é¢˜ã€APIå­—æ®µä¸åŒ¹é…ã€æšä¸¾å€¼é”™è¯¯ç­‰è§£å†³æ–¹æ¡ˆ
- **v2.0**: ä¿®å¤æ€§èƒ½æµ‹è¯•æ¶æ„ï¼Œæ·»åŠ æœåŠ¡å™¨è‡ªåŠ¨ç®¡ç†ï¼Œå®Œå–„é”™è¯¯å¤„ç†
- **v1.5**: æ·»åŠ é›†æˆæµ‹è¯•æ”¯æŒï¼Œç»Ÿä¸€å®¢æˆ·ç«¯æŠ½è±¡
- **v1.0**: åˆå§‹ç‰ˆæœ¬ï¼ŒåŸºç¡€çš„ä¸‰å±‚æµ‹è¯•æ¶æ„

---

è¿™ä¸ªæµ‹è¯•æ¶æ„ä¸ºä¿¡ç”¨å¡ç®¡ç†ç³»ç»Ÿæä¾›äº†å…¨é¢ã€å¯æ‰©å±•ã€æ˜“ç»´æŠ¤çš„æµ‹è¯•è§£å†³æ–¹æ¡ˆã€‚é€šè¿‡ç»Ÿä¸€çš„æ¥å£å’Œåˆ†å±‚çš„è®¾è®¡ï¼Œæ—¢ä¿è¯äº†æµ‹è¯•çš„è¦†ç›–ç‡ï¼Œåˆæä¾›äº†çµæ´»çš„æµ‹è¯•æ‰§è¡Œç­–ç•¥ã€‚æ‰€æœ‰å·²çŸ¥é—®é¢˜éƒ½å·²ä¿®å¤ï¼Œç¡®ä¿æµ‹è¯•æ¡†æ¶çš„ç¨³å®šæ€§å’Œå¯é æ€§ã€‚ 

## ä¿¡ç”¨å¡æ¨¡å—æµ‹è¯•è¯´æ˜

### æµ‹è¯•è¦†ç›–èŒƒå›´

ä¿¡ç”¨å¡æ¨¡å—çš„æµ‹è¯•è¦†ç›–ä»¥ä¸‹åŠŸèƒ½ï¼š

#### å•å…ƒæµ‹è¯• (`test_cards_unit.py`)
- **åŸºç¡€CRUDæ“ä½œ**: åˆ›å»ºã€æŸ¥è¯¢ã€æ›´æ–°ã€åˆ é™¤ä¿¡ç”¨å¡
- **å¹´è´¹ç®¡ç†é›†æˆ**: å¸¦å¹´è´¹çš„ä¿¡ç”¨å¡åˆ›å»ºå’Œç®¡ç†
- **æ•°æ®éªŒè¯**: å¡å·æ ¼å¼ã€æœ‰æ•ˆæœŸã€é¢åº¦ç­‰å­—æ®µéªŒè¯
- **åˆ†é¡µå’Œæœç´¢**: åˆ—è¡¨æŸ¥è¯¢ã€å…³é”®è¯æœç´¢ã€åˆ†é¡µåŠŸèƒ½
- **æƒé™éªŒè¯**: ç”¨æˆ·è®¤è¯ã€æ•°æ®éš”ç¦»æµ‹è¯•
- **è¾¹ç•Œæ¡ä»¶**: æ— æ•ˆæ•°æ®ã€é‡å¤å¡å·ã€è¶…é•¿å­—æ®µç­‰

#### é›†æˆæµ‹è¯• (`test_cards_integration.py`)
- **å®Œæ•´ç”Ÿå‘½å‘¨æœŸ**: ç«¯åˆ°ç«¯çš„ä¿¡ç”¨å¡ç®¡ç†æµç¨‹
- **å¹´è´¹åŠŸèƒ½é›†æˆ**: å¹´è´¹è§„åˆ™çš„å®Œæ•´æµ‹è¯•
- **ç½‘ç»œå±‚éªŒè¯**: HTTPå“åº”å¤´ã€JSONåºåˆ—åŒ–
- **å¹¶å‘æ“ä½œ**: å¤šä¸ªè¯·æ±‚åŒæ—¶å¤„ç†
- **å®‰å…¨æ€§æµ‹è¯•**: è®¤è¯è¦æ±‚ã€ç”¨æˆ·æ•°æ®éš”ç¦»
- **æ•°æ®å®Œæ•´æ€§**: é‡å¤é˜²æŠ¤ã€æ•°æ®éªŒè¯
- **å“åº”æ—¶é—´**: åŸºæœ¬çš„æ€§èƒ½éªŒè¯

#### æ€§èƒ½æµ‹è¯• (`test_cards_performance.py`)
- **å•æ¬¡æ“ä½œåŸºå‡†**: å„ç±»æ“ä½œçš„å“åº”æ—¶é—´è¦æ±‚
- **æ‰¹é‡æ“ä½œæµ‹è¯•**: æ‰¹é‡åˆ›å»ºã€æŸ¥è¯¢çš„æ€§èƒ½è¡¨ç°
- **å¹¶å‘å‹åŠ›æµ‹è¯•**: å¤šç”¨æˆ·åŒæ—¶æ“ä½œçš„æ€§èƒ½
- **æœç´¢æ€§èƒ½**: å…³é”®è¯æœç´¢çš„å“åº”æ—¶é—´
- **åˆ†é¡µæ€§èƒ½**: ä¸åŒé¡µé¢çš„æŸ¥è¯¢æ€§èƒ½
- **å¹´è´¹åŠŸèƒ½æ€§èƒ½**: å¤æ‚å¹´è´¹é€»è¾‘çš„æ€§èƒ½å½±å“
- **ç»¼åˆåœºæ™¯**: æ¨¡æ‹ŸçœŸå®ç”¨æˆ·ä½¿ç”¨çš„æ€§èƒ½è¡¨ç°

### æ€§èƒ½åŸºå‡†

| æ“ä½œç±»å‹ | ç›®æ ‡æ—¶é—´ | è¯´æ˜ |
|---------|---------|------|
| åˆ›å»ºä¿¡ç”¨å¡ | < 2.0ç§’ | å•å¼ å¡ç‰‡åˆ›å»º |
| æŸ¥è¯¢è¯¦æƒ… | < 1.0ç§’ | å•å¼ å¡ç‰‡æŸ¥è¯¢ |
| æ›´æ–°ä¿¡ç”¨å¡ | < 2.0ç§’ | å•å¼ å¡ç‰‡æ›´æ–° |
| è·å–åˆ—è¡¨ | < 1.5ç§’ | åˆ†é¡µåˆ—è¡¨æŸ¥è¯¢ |
| æœç´¢åŠŸèƒ½ | < 1.0ç§’ | å…³é”®è¯æœç´¢ |
| åˆ›å»ºå¹´è´¹å¡ç‰‡ | < 3.0ç§’ | åŒ…å«å¹´è´¹è§„åˆ™åˆ›å»º |
| 5å¹¶å‘åˆ›å»º | æˆåŠŸç‡â‰¥80% | å¹¶å‘åˆ›å»ºæµ‹è¯• |
| 10å¹¶å‘æŸ¥è¯¢ | æˆåŠŸç‡â‰¥95% | å¹¶å‘æŸ¥è¯¢æµ‹è¯• |

### è¿è¡Œä¿¡ç”¨å¡æµ‹è¯•

```bash
# è¿è¡Œä¿¡ç”¨å¡å•å…ƒæµ‹è¯•
python tests/test_runner.py unit --filter=cards

# è¿è¡Œä¿¡ç”¨å¡é›†æˆæµ‹è¯•ï¼ˆéœ€è¦å…ˆå¯åŠ¨æœåŠ¡å™¨ï¼‰
python start.py dev  # ç»ˆç«¯1
python tests/test_runner.py integration --filter=cards  # ç»ˆç«¯2

# è¿è¡Œä¿¡ç”¨å¡æ€§èƒ½æµ‹è¯•
python tests/test_runner.py performance --filter=cards

# è¿è¡Œç‰¹å®šæµ‹è¯•æ–‡ä»¶
pytest tests/unit/test_cards_unit.py -v
pytest tests/integration/test_cards_integration.py -v  
pytest tests/performance/test_cards_performance.py -v
```

### æµ‹è¯•æ•°æ®ç®¡ç†

ä¿¡ç”¨å¡æµ‹è¯•ä½¿ç”¨ä¸“é—¨çš„æµ‹è¯•æ•°æ®ç”Ÿæˆå™¨ï¼š

- **CardTestDataGenerator**: å•å…ƒæµ‹è¯•æ•°æ®ç”Ÿæˆ
- **CardIntegrationTestDataGenerator**: é›†æˆæµ‹è¯•æ•°æ®ç”Ÿæˆ  
- **CardPerformanceDataGenerator**: æ€§èƒ½æµ‹è¯•æ•°æ®ç”Ÿæˆ

æ¯ä¸ªç”Ÿæˆå™¨éƒ½ç¡®ä¿ï¼š
- å”¯ä¸€çš„å¡å·ç”Ÿæˆï¼ˆé¿å…é‡å¤ï¼‰
- çœŸå®çš„æµ‹è¯•æ•°æ®æ ¼å¼
- è‡ªåŠ¨çš„æµ‹è¯•æ•°æ®æ¸…ç†
- æ—¶é—´æˆ³æ ‡è¯†ï¼Œä¾¿äºè°ƒè¯•

### æµ‹è¯•æœ€ä½³å®è·µ

1. **æµ‹è¯•éš”ç¦»**: æ¯ä¸ªæµ‹è¯•æ–¹æ³•éƒ½æœ‰ç‹¬ç«‹çš„æ•°æ®
2. **èµ„æºæ¸…ç†**: æµ‹è¯•å®Œæˆåè‡ªåŠ¨æ¸…ç†åˆ›å»ºçš„æ•°æ®
3. **é”™è¯¯å¤„ç†**: å®Œå–„çš„å¼‚å¸¸æƒ…å†µæµ‹è¯•
4. **æ€§èƒ½ç›‘æ§**: æŒç»­ç›‘æ§APIæ€§èƒ½è¡¨ç°
5. **å¹¶å‘å®‰å…¨**: éªŒè¯å¤šç”¨æˆ·åŒæ—¶æ“ä½œçš„å®‰å…¨æ€§

## ç»Ÿè®¡åŠŸèƒ½æ¨¡å—æµ‹è¯•è¯´æ˜

### æµ‹è¯•è¦†ç›–èŒƒå›´

ç»Ÿè®¡åŠŸèƒ½æ¨¡å—æä¾›å…¨æ–¹ä½çš„æ•°æ®ç»Ÿè®¡æµ‹è¯•è¦†ç›–ï¼š

#### å•å…ƒæµ‹è¯• (`test_statistics_unit.py`) - 30ä¸ªæµ‹è¯•ç”¨ä¾‹
- **åŸºç¡€ç»Ÿè®¡æµ‹è¯•(8ä¸ª)**: æ¦‚è§ˆã€ä¿¡ç”¨å¡ã€é¢åº¦ã€äº¤æ˜“ã€å¹´è´¹ã€åˆ†ç±»ã€æœˆåº¦ã€é“¶è¡Œç»Ÿè®¡
- **æŸ¥è¯¢å‚æ•°ç­›é€‰(6ä¸ª)**: æ—¥æœŸç­›é€‰ã€é“¶è¡Œç­›é€‰ã€å¡ç‰‡ç­›é€‰ã€æ•°é‡é™åˆ¶ã€åŒ…å«æ³¨é”€å¡ç‰‡
- **è¾¹ç•Œæ¡ä»¶æµ‹è¯•(6ä¸ª)**: æ— æ•ˆæ—¥æœŸã€æœªæ¥æ—¥æœŸã€æ— æ•ˆIDã€è¶…å¤§/è´Ÿæ•°é™åˆ¶å€¼ã€ç©ºå‚æ•°
- **æƒé™å®‰å…¨æµ‹è¯•(3ä¸ª)**: æœªæˆæƒè®¿é—®ã€æ— æ•ˆä»¤ç‰Œã€æ•°æ®éš”ç¦»éªŒè¯
- **æ€§èƒ½å“åº”æµ‹è¯•(7ä¸ª)**: å“åº”æ—¶é—´ã€å¹¶å‘è¯·æ±‚ã€å¤æ‚ç­›é€‰ã€æ•°æ®ä¸€è‡´æ€§ã€æ¥å£å¯è®¿é—®æ€§

#### é›†æˆæµ‹è¯• (`test_statistics_integration.py`) - 12ä¸ªæµ‹è¯•ç”¨ä¾‹
- **ç«¯åˆ°ç«¯æµ‹è¯•(4ä¸ª)**: å®Œæ•´ç»Ÿè®¡æµç¨‹ã€è·¨æ¨¡å—æ•°æ®ä¸€è‡´æ€§ã€å®æ—¶æ•°æ®åæ˜ ã€å¤šç”¨æˆ·éš”ç¦»
- **å¤æ‚ä¸šåŠ¡åœºæ™¯(3ä¸ª)**: ç»¼åˆç­›é€‰åœºæ™¯ã€è´Ÿè½½ä¸‹æ€§èƒ½ã€æ•°æ®èšåˆå‡†ç¡®æ€§
- **ç½‘ç»œåè®®æµ‹è¯•(3ä¸ª)**: HTTPå¤´éªŒè¯ã€å“åº”å‹ç¼©ã€é”™è¯¯å¤„ç†æ¢å¤
- **å¹¶å‘å®Œæ•´æ€§(2ä¸ª)**: å¹¶å‘æ“ä½œå®Œæ•´æ€§ã€ç»¼åˆé›†æˆåœºæ™¯

#### æ€§èƒ½æµ‹è¯• (`test_statistics_performance.py`) - 12ä¸ªæµ‹è¯•ç”¨ä¾‹
- **å•æ¬¡æ“ä½œæ€§èƒ½(5ä¸ª)**: æ¦‚è§ˆã€å¡ç‰‡ã€äº¤æ˜“ã€åˆ†ç±»ã€æœˆåº¦è¶‹åŠ¿ç»Ÿè®¡æ€§èƒ½
- **æ‰¹é‡æ“ä½œæ€§èƒ½(3ä¸ª)**: å¤šæ¬¡è¯·æ±‚ã€ç­›é€‰æ¡ä»¶ã€å…¨æ¥å£é¡ºåºæ‰§è¡Œæ€§èƒ½
- **å¹¶å‘æ€§èƒ½æµ‹è¯•(2ä¸ª)**: å¹¶å‘æ¦‚è§ˆè¯·æ±‚ã€å¹¶å‘ä¸åŒç»Ÿè®¡è¯·æ±‚
- **å‹åŠ›æµ‹è¯•(2ä¸ª)**: é«˜è´Ÿè½½æ€§èƒ½ã€æŒç»­è´Ÿè½½æ€§èƒ½

### æ€§èƒ½åŸºå‡†

| ç»Ÿè®¡ç±»å‹ | ç›®æ ‡å“åº”æ—¶é—´ | å¹¶å‘æˆåŠŸç‡ | ååé‡è¦æ±‚ |
|----------|-------------|-----------|-----------|
| ç»Ÿè®¡æ¦‚è§ˆ | < 3.0ç§’ | â‰¥80% | > 3 req/s |
| ä¿¡ç”¨å¡ç»Ÿè®¡ | < 1.5ç§’ | â‰¥90% | > 5 req/s |
| äº¤æ˜“ç»Ÿè®¡ | < 2.0ç§’ | â‰¥85% | > 4 req/s |
| åˆ†ç±»ç»Ÿè®¡ | < 1.5ç§’ | â‰¥90% | > 5 req/s |
| æœˆåº¦è¶‹åŠ¿ | < 2.0ç§’ | â‰¥85% | > 4 req/s |
| ç­›é€‰ç»Ÿè®¡ | < 5.0ç§’ | â‰¥80% | > 2 req/s |
| å…¨æ¥å£é¡ºåº | < 8.0ç§’ | â‰¥80% | - |
| é«˜è´Ÿè½½åœºæ™¯ | < 10.0ç§’ | â‰¥70% | - |

### ç»Ÿè®¡APIæ¥å£

```
/api/statistics/overview       # ç»Ÿè®¡æ¦‚è§ˆï¼ˆç»¼åˆæ‰€æœ‰ç»Ÿè®¡æ•°æ®ï¼‰
/api/statistics/cards          # ä¿¡ç”¨å¡ç»Ÿè®¡  
/api/statistics/credit-limit   # ä¿¡ç”¨é¢åº¦ç»Ÿè®¡
/api/statistics/transactions   # äº¤æ˜“ç»Ÿè®¡
/api/statistics/annual-fee     # å¹´è´¹ç»Ÿè®¡
/api/statistics/categories     # æ¶ˆè´¹åˆ†ç±»ç»Ÿè®¡
/api/statistics/monthly-trends # æœˆåº¦è¶‹åŠ¿ç»Ÿè®¡
/api/statistics/banks          # é“¶è¡Œåˆ†å¸ƒç»Ÿè®¡
```

### è¿è¡Œç»Ÿè®¡åŠŸèƒ½æµ‹è¯•

```bash
# è¿è¡Œç»Ÿè®¡å•å…ƒæµ‹è¯•
python tests/test_runner.py unit --filter=statistics
pytest tests/unit/test_statistics_unit.py -v

# è¿è¡Œç»Ÿè®¡é›†æˆæµ‹è¯•ï¼ˆéœ€è¦å…ˆå¯åŠ¨æœåŠ¡å™¨ï¼‰
python start.py dev  # ç»ˆç«¯1
python tests/test_runner.py integration --filter=statistics  # ç»ˆç«¯2
pytest tests/integration/test_statistics_integration.py -v

# è¿è¡Œç»Ÿè®¡æ€§èƒ½æµ‹è¯•
python tests/test_runner.py performance --filter=statistics
pytest tests/performance/test_statistics_performance.py -v

# è¿è¡Œç‰¹å®šæµ‹è¯•æ–¹æ³•
pytest tests/unit/test_statistics_unit.py::TestStatisticsUnit::test_01_get_statistics_overview_success -v
```

### æµ‹è¯•æ•°æ®ç”Ÿæˆå™¨

ç»Ÿè®¡åŠŸèƒ½æµ‹è¯•ä½¿ç”¨ä¸“é—¨çš„æ•°æ®ç”Ÿæˆå™¨ï¼š

- **StatisticsTestDataGenerator**: å•å…ƒæµ‹è¯•æ•°æ®ï¼ˆä¿¡ç”¨å¡ã€äº¤æ˜“ï¼‰
- **StatisticsIntegrationTestDataGenerator**: é›†æˆæµ‹è¯•æ•°æ®ï¼ˆå¤šå¡å¤šäº¤æ˜“ï¼‰
- **StatisticsPerformanceDataGenerator**: æ€§èƒ½æµ‹è¯•æ•°æ®ï¼ˆå¤§æ‰¹é‡æ•°æ®ï¼‰

### ç»Ÿè®¡åŠŸèƒ½ç‰¹è‰²æµ‹è¯•

1. **å¤šç»´åº¦ç­›é€‰æµ‹è¯•**: æ—¶é—´èŒƒå›´ã€é“¶è¡Œã€å¡ç‰‡ã€çŠ¶æ€ç­‰å¤šé‡ç­›é€‰ç»„åˆ
2. **æ•°æ®èšåˆéªŒè¯**: åˆ†ç±»å æ¯”ã€æœˆåº¦è¶‹åŠ¿ã€é“¶è¡Œåˆ†å¸ƒçš„æ•°å­¦ä¸€è‡´æ€§
3. **å®æ—¶æ•°æ®åæ˜ **: æ–°å¢äº¤æ˜“åç»Ÿè®¡æ•°æ®çš„å®æ—¶æ›´æ–°éªŒè¯
4. **è·¨æ¨¡å—ä¸€è‡´æ€§**: ç»Ÿè®¡æ•°æ®ä¸ä¸šåŠ¡æ¨¡å—æ•°æ®çš„ä¸€è‡´æ€§éªŒè¯

5. **é«˜å¹¶å‘ç¨³å®šæ€§**: å¤šç”¨æˆ·åŒæ—¶æŸ¥è¯¢ç»Ÿè®¡çš„æ€§èƒ½å’Œå‡†ç¡®æ€§ 